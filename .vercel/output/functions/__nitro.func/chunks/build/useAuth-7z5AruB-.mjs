import{ref as e}from"vue";import{useRouter as t}from"vue-router";import{jwtDecode as r}from"jwt-decode";const o=()=>{const a=e(null),l=e(null),n=t(),u=()=>{a.value=null,l.value=null,n.push("/login")};return{user:a,token:l,login:async(e,t)=>{try{const s=await $fetch("/api/auth/login",{method:"POST",body:{email:e,password:t}}),i=r(s.token);return l.value=s.token,a.value={email:i.email,role:i.role,id:i.userId},localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify(a.value)),(e=>{switch(e){case"ADMIN":n.push("/admin");break;case"DOCENTE":n.push("/teacher");break;case"ESTUDIANTE":n.push("/student");break;default:n.push("/")}})(s.role),s}catch(e){throw e}},register:async(e,t,r,a,l,n)=>{try{return await $fetch("/api/auth/register",{method:"POST",body:{email:e,password:t,role:r,documentoIdentidad:a,nombre:l,telefono:n}})}catch(e){throw e}},logout:u,isAuthenticated:()=>!!l.value,getUserRole:()=>{var e;return null==(e=a.value)?void 0:e.role},refreshToken:async()=>{try{const e=await $fetch("/api/auth/refresh",{method:"POST",headers:{Authorization:`Bearer ${l.value}`}}),t=r(e.token);return l.value=e.token,a.value={email:t.email,role:t.role,id:t.userId},localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(a.value)),e.token}catch(e){throw u(),e}}}};export{o};
//# sourceMappingURL=useAuth-7z5AruB-.mjs.map
