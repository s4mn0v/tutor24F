import{defineComponent as r,useId as e,ref as t,provide as n,readonly as a,useSSRContext as s}from"vue";import{useEventBus as i}from"@vueuse/core";import{ssrRenderAttrs as o,ssrRenderSlot as u}from"vue/server-renderer";import{_ as l}from"./entry-B1wW15I9.mjs";import"../nitro/nitro.mjs";import"mammoth";import"pdf.js-extract";import"node:http";import"node:https";import"@vercel/kv";import"@iconify/utils";import"consola/core";import"unhead";import"@unhead/shared";import"vue-router";import"@prisma/client";import"tailwind-merge";import"@iconify/vue";import"vue3-apexcharts";class c extends Error{constructor(r){super(r),this.message=r,Object.setPrototypeOf(this,c.prototype)}}const m=r({props:{schema:{type:[Object,Function],default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]},validateOn:{type:Array,default:()=>["blur","input","change","submit"]}},emits:["submit","error"],setup(r,{expose:s,emit:o}){const u=e(),l=i(`form-${u}`),m=t(null),p=t([]);n("form-errors",p),n("form-events",l);const f=t({});async function d(){let e=await r.validate(r.state);if(r.schema){const{errors:t,result:n}=await function(r,e){if(void 0!==e.parse)return async function(r,e){const t=await e.safeParseAsync(r);return!1===t.success?{errors:t.error.issues.map((r=>({path:r.path.join("."),message:r.message}))),result:null}:{result:t.data,errors:null}}(r,e);if(function(r){return void 0!==r.validateAsync&&void 0!==r.id}(e))return async function(r,e){try{return{errors:null,result:await e.validateAsync(r,{abortEarly:!1})}}catch(r){if(!0===r.isJoi)return{errors:r.details.map((r=>({path:r.path.join("."),message:r.message}))),result:null};throw r}}(r,e);if(function(r){return"_parse"in r||"_run"in r||"function"==typeof r&&"schema"in r}(e))return async function(r,e){const t=await("_parse"in e?e._parse(r):"_run"in e?e._run({typed:!1,value:r},{}):e(r));if(!t.issues||0===t.issues.length)return{errors:null,result:"output"in t?t.output:"value"in t?t.value:null};return{errors:t.issues.map((r=>{var e;return{path:(null==(e=r.path)?void 0:e.map((r=>r.key)).join("."))||"",message:r.message}})),result:null}}(r,e);if(function(r){return r.validate&&r.__isYupSchema__}(e))return async function(r,e){try{return{errors:null,result:await e.validate(r,{abortEarly:!1})}}catch(r){if(void 0!==r.inner)return{errors:r.inner.map((r=>{var e;return{path:null!=(e=r.path)?e:"",message:r.message}})),result:null};throw r}}(r,e);if(function(r){return"schema"in r&&"function"==typeof r.coercer&&"function"==typeof r.validator&&"function"==typeof r.refiner}(e))return async function(r,e){const[t,n]=e.validate(r);return t?{errors:t.failures().map((r=>({message:r.message,path:r.path.join(".")}))),result:null}:{errors:null,result:n}}(r,e);throw new Error("Form validation failed: Unsupported form schema")}(r.state,r.schema);t?e=e.concat(t):m.value=n}return e}async function v(e,t={silent:!1}){let n=e;if(e&&!Array.isArray(e)&&(n=[e]),n){const r=p.value.filter((r=>!n.includes(r.path))),e=(await d()).filter((r=>n.includes(r.path)));p.value=r.concat(e)}else p.value=await d();if(p.value.length>0){if(t.silent)return!1;throw new c(`Form validation failed: ${JSON.stringify(p.value,null,2)}`)}return r.state}async function h(e){var t;const n=e;try{(null==(t=r.validateOn)?void 0:t.includes("submit"))&&await v(),n.data=r.schema?m.value:r.state,o("submit",n)}catch(r){if(!(r instanceof c))throw r;const e={...n,errors:p.value.map((r=>({...r,id:f.value[r.path]})))};o("error",e)}}return n("form-inputs",f),s({validate:v,errors:p,setErrors(r,e){p.value=e?p.value.filter((r=>r.path!==e)).concat(r):r},async submit(){await h(new Event("submit"))},getErrors:r=>r?p.value.filter((e=>e.path===r)):p.value,clear(r){p.value=r?p.value.filter((e=>e.path!==r)):[]}}),{onSubmit:h,errors:a(p)}}}),p=m.setup;m.setup=(r,e)=>{const t=s();return(t.modules||(t.modules=new Set)).add("node_modules/@nuxt/ui/dist/runtime/components/forms/Form.vue"),p?p(r,e):void 0};const f=l(m,[["ssrRender",function(r,e,t,n,a,s,i,l){e(`<form${o(n)}>`),u(r.$slots,"default",{errors:r.errors},null,e,t),e("</form>")}]]);export{f as default};
//# sourceMappingURL=Form-No2qvc6o.mjs.map
