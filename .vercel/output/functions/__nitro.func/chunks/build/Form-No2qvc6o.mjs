import{defineComponent as r,useId as t,ref as e,provide as s,readonly as a,useSSRContext as n}from"vue";import{useEventBus as o}from"@vueuse/core";import{ssrRenderAttrs as i,ssrRenderSlot as u}from"vue/server-renderer";import{_ as l}from"./entry-B1wW15I9.mjs";import"../nitro/nitro.mjs";import"underscore";import"bluebird/js/release/promise";import"base64-js";import"jszip";import"@xmldom/xmldom";import"@xmldom/xmldom/lib/dom";import"xmlbuilder";import"dingbat-to-unicode";import"fs";import"url";import"os";import"path";import"path-is-absolute";import"pdf.js-extract";import"node:http";import"node:https";import"@vercel/kv";import"@iconify/utils";import"consola/core";import"unhead";import"@unhead/shared";import"vue-router";import"@prisma/client";import"tailwind-merge";import"@iconify/vue";import"vue3-apexcharts";class c extends Error{constructor(r){super(r),this.message=r,Object.setPrototypeOf(this,c.prototype)}}const m=r({props:{schema:{type:[Object,Function],default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]},validateOn:{type:Array,default:()=>["blur","input","change","submit"]}},emits:["submit","error"],setup(r,{expose:n,emit:i}){const u=t(),l=o(`form-${u}`),m=e(null),p=e([]);s("form-errors",p),s("form-events",l);const f=e({});async function d(){let t=await r.validate(r.state);if(r.schema){const{errors:e,result:s}=await function(r,t){if(void 0!==t.parse)return async function(r,t){const e=await t.safeParseAsync(r);return!1===e.success?{errors:e.error.issues.map((r=>({path:r.path.join("."),message:r.message}))),result:null}:{result:e.data,errors:null}}(r,t);if(function(r){return void 0!==r.validateAsync&&void 0!==r.id}(t))return async function(r,t){try{return{errors:null,result:await t.validateAsync(r,{abortEarly:!1})}}catch(r){if(!0===r.isJoi)return{errors:r.details.map((r=>({path:r.path.join("."),message:r.message}))),result:null};throw r}}(r,t);if(function(r){return"_parse"in r||"_run"in r||"function"==typeof r&&"schema"in r}(t))return async function(r,t){const e=await("_parse"in t?t._parse(r):"_run"in t?t._run({typed:!1,value:r},{}):t(r));if(!e.issues||0===e.issues.length)return{errors:null,result:"output"in e?e.output:"value"in e?e.value:null};return{errors:e.issues.map((r=>{var t;return{path:(null==(t=r.path)?void 0:t.map((r=>r.key)).join("."))||"",message:r.message}})),result:null}}(r,t);if(function(r){return r.validate&&r.__isYupSchema__}(t))return async function(r,t){try{return{errors:null,result:await t.validate(r,{abortEarly:!1})}}catch(r){if(void 0!==r.inner)return{errors:r.inner.map((r=>{var t;return{path:null!=(t=r.path)?t:"",message:r.message}})),result:null};throw r}}(r,t);if(function(r){return"schema"in r&&"function"==typeof r.coercer&&"function"==typeof r.validator&&"function"==typeof r.refiner}(t))return async function(r,t){const[e,s]=t.validate(r);return e?{errors:e.failures().map((r=>({message:r.message,path:r.path.join(".")}))),result:null}:{errors:null,result:s}}(r,t);throw new Error("Form validation failed: Unsupported form schema")}(r.state,r.schema);e?t=t.concat(e):m.value=s}return t}async function v(t,e={silent:!1}){let s=t;if(t&&!Array.isArray(t)&&(s=[t]),s){const r=p.value.filter((r=>!s.includes(r.path))),t=(await d()).filter((r=>s.includes(r.path)));p.value=r.concat(t)}else p.value=await d();if(p.value.length>0){if(e.silent)return!1;throw new c(`Form validation failed: ${JSON.stringify(p.value,null,2)}`)}return r.state}async function h(t){var e;const s=t;try{(null==(e=r.validateOn)?void 0:e.includes("submit"))&&await v(),s.data=r.schema?m.value:r.state,i("submit",s)}catch(r){if(!(r instanceof c))throw r;const t={...s,errors:p.value.map((r=>({...r,id:f.value[r.path]})))};i("error",t)}}return s("form-inputs",f),n({validate:v,errors:p,setErrors(r,t){p.value=t?p.value.filter((r=>r.path!==t)).concat(r):r},async submit(){await h(new Event("submit"))},getErrors:r=>r?p.value.filter((t=>t.path===r)):p.value,clear(r){p.value=r?p.value.filter((t=>t.path!==r)):[]}}),{onSubmit:h,errors:a(p)}}}),p=m.setup;m.setup=(r,t)=>{const e=n();return(e.modules||(e.modules=new Set)).add("node_modules/@nuxt/ui/dist/runtime/components/forms/Form.vue"),p?p(r,t):void 0};const f=l(m,[["ssrRender",function(r,t,e,s,a,n,o,l){t(`<form${i(s)}>`),u(r.$slots,"default",{errors:r.errors},null,t,e),t("</form>")}]]);export{f as default};
//# sourceMappingURL=Form-No2qvc6o.mjs.map
