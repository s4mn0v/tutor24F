import{defineComponent as e,ref as a,computed as t,watch as r,mergeProps as o,withCtx as l,createVNode as d,withModifiers as i,createTextVNode as n,useSSRContext as s}from"vue";import{ssrRenderComponent as u,ssrRenderAttrs as c,ssrInterpolate as m,ssrRenderList as p,ssrRenderClass as v,ssrIncludeBooleanAttr as g}from"vue/server-renderer";import b from"./Modal-ButbbXX6.mjs";import h from"./FormGroup-YgMxEyO3.mjs";import x from"./Input-CPH3LW_6.mjs";import f from"./Textarea-C0w0Xp65.mjs";import y from"./Select-BZ-soWGI.mjs";import w from"./Button-C-PkUfPN.mjs";import{o as V}from"./useAuth-7z5AruB-.mjs";import{_ as k}from"./entry-B1wW15I9.mjs";import"./transition-Ccui9lse.mjs";import"./portal-DUbJEEiU.mjs";import"./focus-management-DUDUmKqn.mjs";import"./keyboard-CrgOGGit.mjs";import"./use-outside-click-qQ0I4h8Q.mjs";import"./hidden-CFl4aoYx.mjs";import"./active-element-history-BCSenD5G.mjs";import"./micro-task-Yfl05yA4.mjs";import"./open-closed-pt2NNRlg.mjs";import"./description-CM0EfvpF.mjs";import"./tooltip-P8fr8pDa.mjs";import"../nitro/nitro.mjs";import"mammoth";import"pdf.js-extract";import"node:http";import"node:https";import"@vercel/kv";import"@iconify/utils";import"consola/core";import"unhead";import"@unhead/shared";import"vue-router";import"@prisma/client";import"@vueuse/core";import"tailwind-merge";import"@iconify/vue";import"vue3-apexcharts";import"./Icon-Di_vDYyH.mjs";import"./index-CQS-gLPq.mjs";import"@iconify/utils/lib/css/icon";import"./useFormGroup-Dj1FOV-7.mjs";import"./useButtonGroup-DOVi4PLM.mjs";import"./Link-BdFoBY4y.mjs";import"./link-Ch5OrHHS.mjs";import"./button-CHOj1P8S.mjs";import"jwt-decode";const j=e({__name:"Calendar",__ssrInlineRender:!0,setup(e){const{token:s,refreshToken:k}=V(),j=a(new Date),D=a(null),I=a(!1),U=a(!1),_=a([]),A=a([]),S=a(null),C=a({title:"",description:"",asignaturaId:0,importance:""}),$=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],M=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],T=t((()=>M[j.value.getMonth()])),q=t((()=>j.value.getFullYear())),B=t((()=>{const e=j.value.getFullYear(),a=j.value.getMonth(),t=new Date(e,a,1),r=new Date(e,a+1,0).getDate(),o=t.getDay(),l=[];for(let t=0;t<o;t++){const r=new Date(e,a,-o+t+1);l.push({date:r,isCurrentMonth:!1,isToday:F(r)})}for(let t=1;t<=r;t++){const r=new Date(e,a,t);l.push({date:r,isCurrentMonth:!0,isToday:F(r)})}const d=42-l.length;for(let t=1;t<=d;t++){const r=new Date(e,a+1,t);l.push({date:r,isCurrentMonth:!1,isToday:F(r)})}return l})),E=t((()=>A.value.map((e=>({label:e.nombre,value:e.id}))))),z=[{label:"Baja",value:"BAJA"},{label:"Media",value:"MEDIA"},{label:"Alta",value:"ALTA"}],J=e=>D.value&&e.toDateString()===D.value.toDateString(),F=e=>{const a=new Date;return e.toDateString()===a.toDateString()},G=e=>{const a=new Date;return a.setHours(0,0,0,0),e>=a},R=e=>{switch(e){case"BAJA":return"border-l-4 border-green-500 bg-green-50 dark:bg-green-900";case"MEDIA":return"border-l-4 border-yellow-500 bg-yellow-50 dark:bg-yellow-900";case"ALTA":return"border-l-4 border-red-500 bg-red-50 dark:bg-red-900";default:return"border-l-4 border-gray-500 bg-zinc-50 dark:bg-zinc-800"}},L=(e,a)=>{S.value={message:e,type:a},setTimeout((()=>{S.value=null}),5e3)},N=async(e,a={})=>{const t={...a.headers,Authorization:`Bearer ${s.value}`,"Content-Type":"application/json"};try{const r=await fetch(e,{...a,headers:t});return 401===r.status?(await k(),t.Authorization=`Bearer ${s.value}`,fetch(e,{...a,headers:t})):r}catch(e){throw e}},O$1=async()=>{try{const e=await N("/api/docente/eventos");if(!e.ok)throw new Error("Error al obtener recordatorios");const a=await e.json();Array.isArray(a.eventos)?_.value=a.eventos.map((e=>({id:e.id,titulo:e.title,descripcion:e.description,fecha:e.date,asignaturaId:e.asignatura.id,importancia:e.importance}))):_.value=[],Array.isArray(a.asignaturas)?A.value=a.asignaturas:A.value=[]}catch(e){L("Error al cargar los datos. Por favor, intenta de nuevo más tarde.","error")}},P=async()=>{if(D.value&&C.value.title&&C.value.asignaturaId&&C.value.importance){U.value=!0;try{const e=await N("/api/docente/eventos",{method:"POST",body:JSON.stringify({title:C.value.title,description:C.value.description,date:D.value.toISOString(),asignaturaId:C.value.asignaturaId,importance:C.value.importance})});if(!e.ok){const a=await e.json();throw new Error(a.message||"Error al crear recordatorio")}await O$1(),I.value=!1,C.value={title:"",description:"",asignaturaId:0,importance:""},L("Recordatorio creado exitosamente","success")}catch(e){L("Error al crear el recordatorio: "+e.message,"error")}finally{U.value=!1}}else L("Por favor, completa todos los campos requeridos.","error")};return r(j,O$1),(e,a,t,r)=>{const s=b,V=h,k=x,j=f,D=y,M=w;a(`<div${c(o({class:"min-h-screen bg-white dark:bg-transparent"},r))} data-v-002d6c54><div class="max-w-7xl mx-auto bg-white dark:bg-zinc-800 rounded-xl shadow-lg overflow-hidden" data-v-002d6c54><div class="flex flex-col lg:flex-row" data-v-002d6c54><div class="w-full lg:w-2/3 p-4" data-v-002d6c54><div class="flex justify-between items-center mb-6" data-v-002d6c54><h2 class="text-xl lg:text-2xl font-bold text-gray-800 dark:text-white" data-v-002d6c54>${m(T.value)} ${m(q.value)}</h2><div class="flex space-x-2" data-v-002d6c54><button class="p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-900 transition-colors" data-v-002d6c54><i class="i-heroicons-chevron-left-20-solid w-5 h-5 text-gray-600 dark:text-gray-300" data-v-002d6c54></i></button><button class="p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors" data-v-002d6c54><i class="i-heroicons-chevron-right-20-solid w-5 h-5 text-gray-600 dark:text-gray-300" data-v-002d6c54></i></button></div></div><div class="grid grid-cols-7 gap-1 mb-2" data-v-002d6c54>\x3c!--[--\x3e`),p($,(e=>{a(`<div class="text-center font-semibold text-gray-600 dark:text-gray-400 text-xs lg:text-sm" data-v-002d6c54>${m(e)}</div>`)})),a('\x3c!--]--\x3e</div><div class="grid grid-cols-7 gap-1" data-v-002d6c54>\x3c!--[--\x3e'),p(B.value,(({date:e,isCurrentMonth:t,isToday:r})=>{a(`<button class="${v(["p-1 w-full aspect-square rounded-lg text-center transition-colors text-xs lg:text-sm",t?"hover:bg-blue-100 dark:hover:bg-blue-900":"text-gray-400 dark:text-gray-600",r?"bg-blue-200 dark:bg-blue-800 font-bold":"",J(e)?"bg-blue-500 text-white":"",G(e)?"cursor-pointer":"cursor-not-allowed"])}"${g(!G(e))?" disabled":""} data-v-002d6c54><span data-v-002d6c54>${m(e.getDate())}</span></button>`)})),a('\x3c!--]--\x3e</div></div><div class="w-full lg:w-1/3 border-t lg:border-t-0 lg:border-l border-gray-200 dark:border-gray-700 p-4" data-v-002d6c54><h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white" data-v-002d6c54>Recordatorios</h3><div class="overflow-y-auto max-h-[calc(100vh-16rem)]" data-v-002d6c54>'),_.value.length?(a('<ul class="space-y-2" data-v-002d6c54>\x3c!--[--\x3e'),p(_.value,(e=>{var t;a(`<li class="${v(["p-3 rounded-lg mb-2 relative",R(e.importancia)])}" data-v-002d6c54><button class="absolute top-2 right-2 text-red-500 hover:text-red-700 dark:hover:text-red-400" aria-label="Eliminar recordatorio" data-v-002d6c54><i class="i-heroicons-trash-20-solid w-5 h-5" data-v-002d6c54></i></button><div data-v-002d6c54><h4 class="font-semibold text-gray-800 dark:text-white" data-v-002d6c54>${m(e.titulo)}</h4><p class="text-sm text-gray-600 dark:text-gray-400" data-v-002d6c54>${m(e.descripcion)}</p><p class="text-xs text-gray-500 dark:text-gray-500 mt-1" data-v-002d6c54> Fecha: ${m((t=new Date(e.fecha),t.toLocaleDateString("es",{weekday:"long",year:"numeric",month:"long",day:"numeric"})))}</p><p class="text-xs text-gray-500 dark:text-gray-500 mt-1" data-v-002d6c54> Asignatura: ${m((e=>{const a=A.value.find((a=>a.id===e));return a?a.nombre:"Desconocida"})(e.asignaturaId))}</p></div></li>`)})),a("\x3c!--]--\x3e</ul>")):a('<p class="text-gray-600 dark:text-gray-400" data-v-002d6c54>No hay recordatorios.</p>'),a("</div></div></div></div>"),a(u(s,{modelValue:I.value,"onUpdate:modelValue":e=>I.value=e},{default:l(((e,a,t,r)=>{if(!a)return[d("div",{class:"bg-white dark:bg-zinc-800 rounded-lg p-6"},[d("h3",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-white"},"Nuevo Recordatorio"),d("form",{onSubmit:i(P,["prevent"]),class:"space-y-4"},[d(V,{label:"Título",name:"title"},{default:l((()=>[d(k,{modelValue:C.value.title,"onUpdate:modelValue":e=>C.value.title=e,placeholder:"Título del recordatorio",required:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),d(V,{label:"Descripción",name:"description"},{default:l((()=>[d(j,{modelValue:C.value.description,"onUpdate:modelValue":e=>C.value.description=e,placeholder:"Descripción del recordatorio"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),d(V,{label:"Asignatura",name:"asignatura"},{default:l((()=>[d(D,{modelValue:C.value.asignaturaId,"onUpdate:modelValue":e=>C.value.asignaturaId=e,options:E.value,placeholder:"Selecciona una asignatura",required:""},null,8,["modelValue","onUpdate:modelValue","options"])])),_:1}),d(V,{label:"Importancia",name:"importance"},{default:l((()=>[d(D,{modelValue:C.value.importance,"onUpdate:modelValue":e=>C.value.importance=e,options:z,placeholder:"Selecciona la importancia",required:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),d("div",{class:"flex justify-end space-x-2"},[d(M,{color:"gray",onClick:e=>I.value=!1},{default:l((()=>[n("Cancelar")])),_:1},8,["onClick"]),d(M,{color:"primary",type:"submit",loading:U.value},{default:l((()=>[n("Guardar")])),_:1},8,["loading"])])],32)])];a(`<div class="bg-white dark:bg-zinc-800 rounded-lg p-6" data-v-002d6c54${r}><h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white" data-v-002d6c54${r}>Nuevo Recordatorio</h3><form class="space-y-4" data-v-002d6c54${r}>`),a(u(V,{label:"Título",name:"title"},{default:l(((e,a,t,r)=>{if(!a)return[d(k,{modelValue:C.value.title,"onUpdate:modelValue":e=>C.value.title=e,placeholder:"Título del recordatorio",required:""},null,8,["modelValue","onUpdate:modelValue"])];a(u(k,{modelValue:C.value.title,"onUpdate:modelValue":e=>C.value.title=e,placeholder:"Título del recordatorio",required:""},null,t,r))})),_:1},t,r)),a(u(V,{label:"Descripción",name:"description"},{default:l(((e,a,t,r)=>{if(!a)return[d(j,{modelValue:C.value.description,"onUpdate:modelValue":e=>C.value.description=e,placeholder:"Descripción del recordatorio"},null,8,["modelValue","onUpdate:modelValue"])];a(u(j,{modelValue:C.value.description,"onUpdate:modelValue":e=>C.value.description=e,placeholder:"Descripción del recordatorio"},null,t,r))})),_:1},t,r)),a(u(V,{label:"Asignatura",name:"asignatura"},{default:l(((e,a,t,r)=>{if(!a)return[d(D,{modelValue:C.value.asignaturaId,"onUpdate:modelValue":e=>C.value.asignaturaId=e,options:E.value,placeholder:"Selecciona una asignatura",required:""},null,8,["modelValue","onUpdate:modelValue","options"])];a(u(D,{modelValue:C.value.asignaturaId,"onUpdate:modelValue":e=>C.value.asignaturaId=e,options:E.value,placeholder:"Selecciona una asignatura",required:""},null,t,r))})),_:1},t,r)),a(u(V,{label:"Importancia",name:"importance"},{default:l(((e,a,t,r)=>{if(!a)return[d(D,{modelValue:C.value.importance,"onUpdate:modelValue":e=>C.value.importance=e,options:z,placeholder:"Selecciona la importancia",required:""},null,8,["modelValue","onUpdate:modelValue"])];a(u(D,{modelValue:C.value.importance,"onUpdate:modelValue":e=>C.value.importance=e,options:z,placeholder:"Selecciona la importancia",required:""},null,t,r))})),_:1},t,r)),a(`<div class="flex justify-end space-x-2" data-v-002d6c54${r}>`),a(u(M,{color:"gray",onClick:e=>I.value=!1},{default:l(((e,a,t,r)=>{if(!a)return[n("Cancelar")];a("Cancelar")})),_:1},t,r)),a(u(M,{color:"primary",type:"submit",loading:U.value},{default:l(((e,a,t,r)=>{if(!a)return[n("Guardar")];a("Guardar")})),_:1},t,r)),a("</div></form></div>")})),_:1},t)),S.value?a(`<div class="${v(["fixed bottom-4 right-4 p-4 rounded-lg shadow-lg transition-opacity duration-300",{"bg-green-500":"success"===S.value.type,"bg-red-500":"error"===S.value.type,"bg-blue-500":"info"===S.value.type,"bg-yellow-500":"warning"===S.value.type}])}" data-v-002d6c54>${m(S.value.message)}</div>`):a("\x3c!----\x3e"),a("</div>")}}}),D=j.setup;j.setup=(e,a)=>{const t=s();return(t.modules||(t.modules=new Set)).add("components/teacher/Calendar.vue"),D?D(e,a):void 0};const I=k(j,[["__scopeId","data-v-002d6c54"]]),U=e({__name:"calendar",__ssrInlineRender:!0,setup:e=>(e,a,t,r)=>{a(u(I,r,null,t))}}),_=U.setup;U.setup=(e,a)=>{const t=s();return(t.modules||(t.modules=new Set)).add("pages/teacher/calendar.vue"),_?_(e,a):void 0};export{U as default};
//# sourceMappingURL=calendar-DMDTfDoV.mjs.map
