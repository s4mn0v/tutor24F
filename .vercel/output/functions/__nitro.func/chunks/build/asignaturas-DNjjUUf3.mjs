import{mergeProps as e,defineComponent as a,ref as r,reactive as t,withCtx as l,createVNode as o,createBlock as n,createTextVNode as s,openBlock as d,Fragment as i,renderList as u,createCommentVNode as c,toDisplayString as m,withModifiers as p,useSSRContext as g}from"vue";import{ssrRenderAttrs as f,ssrRenderComponent as x,ssrRenderList as b,ssrInterpolate as y}from"vue/server-renderer";import v from"./Container-CR9JBCRG.mjs";import h from"./Button-C-PkUfPN.mjs";import C from"./Card-B6mXdLK8.mjs";import j from"./Badge-vGsyLI_b.mjs";import k from"./Modal-ButbbXX6.mjs";import V from"./Form-No2qvc6o.mjs";import _ from"./FormGroup-YgMxEyO3.mjs";import $ from"./Input-CPH3LW_6.mjs";import U from"./Select-BZ-soWGI.mjs";import{useRouter as w}from"vue-router";import{e as E}from"./useToast-B0UDgBav.mjs";import{_ as I}from"./entry-B1wW15I9.mjs";import"tailwind-merge";import"./tooltip-P8fr8pDa.mjs";import"./Link-BdFoBY4y.mjs";import"../nitro/nitro.mjs";import"mammoth";import"pdf.js-extract";import"node:http";import"node:https";import"@vercel/kv";import"@iconify/utils";import"consola/core";import"./link-Ch5OrHHS.mjs";import"unhead";import"@unhead/shared";import"@prisma/client";import"@vueuse/core";import"@iconify/vue";import"vue3-apexcharts";import"./Icon-Di_vDYyH.mjs";import"./index-CQS-gLPq.mjs";import"@iconify/utils/lib/css/icon";import"./useButtonGroup-DOVi4PLM.mjs";import"./button-CHOj1P8S.mjs";import"./transition-Ccui9lse.mjs";import"./portal-DUbJEEiU.mjs";import"./focus-management-DUDUmKqn.mjs";import"./keyboard-CrgOGGit.mjs";import"./use-outside-click-qQ0I4h8Q.mjs";import"./hidden-CFl4aoYx.mjs";import"./active-element-history-BCSenD5G.mjs";import"./micro-task-Yfl05yA4.mjs";import"./open-closed-pt2NNRlg.mjs";import"./description-CM0EfvpF.mjs";import"./useFormGroup-Dj1FOV-7.mjs";const A=a({__name:"SubjectPanel",__ssrInlineRender:!0,setup(a){const g=w(),I=E(),A=r(!1),N=r([]),q=r(!1),S=t({nombre:"",carrera:"",jornada:""}),R2=async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("No autenticado");const a=await $fetch("/api/asignaturas",{headers:{Authorization:`Bearer ${e}`}});N.value=a}catch(e){I.add({title:"Error al cargar las asignaturas",color:"red"})}},z$3=async()=>{if(S.nombre&&S.carrera&&S.jornada){A.value=!0;try{const e=localStorage.getItem("token");if(!e)throw new Error("No autenticado");await $fetch("/api/asignaturas/create",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:{nombre:S.nombre,carrera:S.carrera,jornada:S.jornada}})&&(I.add({title:"Asignatura creada exitosamente!",color:"green"}),S.nombre="",S.carrera="",S.jornada="",q.value=!1,await R2())}catch(e){I.add({title:e instanceof Error?e.message:"Hubo un error al crear la asignatura",color:"red"})}finally{A.value=!1}}else I.add({title:"Por favor, completa todos los campos",color:"yellow"})},D=async e=>{try{const a=await $fetch(`/api/asignaturas/${e}/generate-link`,{method:"POST"});a&&a.enlaceRegistro&&(I.add({title:"Enlace generado exitosamente! Tiene una duración de 20 minutos.",color:"green"}),await R2())}catch(e){I.add({title:"Hubo un error al generar el enlace",color:"red"})}},G=async e=>{if(confirm("¿Estás seguro de que deseas eliminar esta asignatura?"))try{await $fetch(`/api/asignaturas/${e}`,{method:"DELETE"}),I.add({title:"Asignatura eliminada exitosamente",color:"green"}),await R2()}catch(e){I.add({title:"Hubo un error al eliminar la asignatura",color:"red"})}},J=e=>{(void 0).clipboard.writeText(`${(void 0).location.origin}/inscribir?enlace=${e}`),I.add({title:"Enlace copiado al portapapeles!",color:"green"})},T$1=e=>{g.push(`/teacher/asignatura/${e}`)},B=e=>e?new Date(e).toLocaleString():"N/A";return(a,r,t,g)=>{const w=v,E=h,I=C,P=j,R=k,z=V,H=_,L=$,O=U;r(`<div${f(e({class:"bg-transparent p-4 sm:p-6"},g))}>`),r(x(w,null,{default:l(((e,a,r,t)=>{if(!a)return[o("div",{class:"flex flex-col sm:flex-row justify-between items-center mb-6 space-y-4 sm:space-y-0"},[o("h2",{class:"text-2xl font-bold text-blue-600"},"Asignaturas"),o(E,{color:"blue",onClick:e=>q.value=!0,icon:"i-heroicons-plus"},{default:l((()=>[s(" Crear Asignatura ")])),_:1},8,["onClick"])]),N.value.length>0?(d(),n("div",{key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6"},[(d(!0),n(i,null,u(N.value,(e=>(d(),n(I,{key:e.id,class:"bg-white/80 dark:bg-gray-800/80 hover:shadow-lg transition-shadow duration-300 cursor-pointer",onClick:a=>T$1(e.id)},{header:l((()=>[o("h3",{class:"text-lg sm:text-xl font-bold text-center text-blue-600 uppercase"},m(e.nombre),1)])),footer:l((()=>[o("div",{class:"flex justify-between items-center"},[o(E,{onClick:p((a=>D(e.id)),["stop"]),color:"blue",size:"sm"},{default:l((()=>[s(" Generar Enlace ")])),_:2},1032,["onClick"]),o(E,{onClick:p((a=>G(e.id)),["stop"]),color:"red",size:"sm"},{default:l((()=>[s(" Eliminar ")])),_:2},1032,["onClick"])])])),default:l((()=>{var a;return[o("div",{class:"p-4"},[o("p",{class:"text-sm text-gray-600 dark:text-gray-300"},[o("strong",null,"Carrera:"),s(" "+m(e.carrera),1)]),o("p",{class:"text-sm text-gray-600 dark:text-gray-300"},[o("strong",null,"Jornada:"),s(" "+m(e.jornada),1)]),o("p",{class:"text-sm text-gray-600 dark:text-gray-300"},[o("strong",null,"Inscritos:"),s(" "+m((null==(a=e.estudiantes)?void 0:a.length)||0),1)]),e.enlaceRegistro?(d(),n("p",{key:0,class:"text-sm text-gray-600 dark:text-gray-300 mt-2"},[o("strong",null,"Enlace de registro:"),o(P,{color:"blue",class:"ml-2 cursor-pointer",onClick:p((a=>J(e.enlaceRegistro)),["stop"])},{default:l((()=>[s(" Copiar enlace ")])),_:2},1032,["onClick"])])):c("",!0),o("p",{class:"text-sm text-gray-600 dark:text-gray-300"},[o("strong",null,"Expira:"),s(" "+m(B(e.fechaExpiracion)),1)])])]})),_:2},1032,["onClick"])))),128))])):(d(),n("div",{key:1,class:"text-center text-gray-600 dark:text-gray-400 py-8"}," No hay asignaturas creadas. "))];a(`<div class="flex flex-col sm:flex-row justify-between items-center mb-6 space-y-4 sm:space-y-0"${t}><h2 class="text-2xl font-bold text-blue-600"${t}>Asignaturas</h2>`),a(x(E,{color:"blue",onClick:e=>q.value=!0,icon:"i-heroicons-plus"},{default:l(((e,a,r,t)=>{if(!a)return[s(" Crear Asignatura ")];a(" Crear Asignatura ")})),_:1},r,t)),a("</div>"),N.value.length>0?(a(`<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6"${t}>\x3c!--[--\x3e`),b(N.value,(e=>{a(x(I,{key:e.id,class:"bg-white/80 dark:bg-gray-800/80 hover:shadow-lg transition-shadow duration-300 cursor-pointer",onClick:a=>T$1(e.id)},{header:l(((a,r,t,l)=>{if(!r)return[o("h3",{class:"text-lg sm:text-xl font-bold text-center text-blue-600 uppercase"},m(e.nombre),1)];r(`<h3 class="text-lg sm:text-xl font-bold text-center text-blue-600 uppercase"${l}>${y(e.nombre)}</h3>`)})),footer:l(((a,r,t,n)=>{if(!r)return[o("div",{class:"flex justify-between items-center"},[o(E,{onClick:p((a=>D(e.id)),["stop"]),color:"blue",size:"sm"},{default:l((()=>[s(" Generar Enlace ")])),_:2},1032,["onClick"]),o(E,{onClick:p((a=>G(e.id)),["stop"]),color:"red",size:"sm"},{default:l((()=>[s(" Eliminar ")])),_:2},1032,["onClick"])])];r(`<div class="flex justify-between items-center"${n}>`),r(x(E,{onClick:a=>D(e.id),color:"blue",size:"sm"},{default:l(((e,a,r,t)=>{if(!a)return[s(" Generar Enlace ")];a(" Generar Enlace ")})),_:2},t,n)),r(x(E,{onClick:a=>G(e.id),color:"red",size:"sm"},{default:l(((e,a,r,t)=>{if(!a)return[s(" Eliminar ")];a(" Eliminar ")})),_:2},t,n)),r("</div>")})),default:l(((a,r,t,i)=>{var u,g;if(!r)return[o("div",{class:"p-4"},[o("p",{class:"text-sm text-gray-600 dark:text-gray-300"},[o("strong",null,"Carrera:"),s(" "+m(e.carrera),1)]),o("p",{class:"text-sm text-gray-600 dark:text-gray-300"},[o("strong",null,"Jornada:"),s(" "+m(e.jornada),1)]),o("p",{class:"text-sm text-gray-600 dark:text-gray-300"},[o("strong",null,"Inscritos:"),s(" "+m((null==(g=e.estudiantes)?void 0:g.length)||0),1)]),e.enlaceRegistro?(d(),n("p",{key:0,class:"text-sm text-gray-600 dark:text-gray-300 mt-2"},[o("strong",null,"Enlace de registro:"),o(P,{color:"blue",class:"ml-2 cursor-pointer",onClick:p((a=>J(e.enlaceRegistro)),["stop"])},{default:l((()=>[s(" Copiar enlace ")])),_:2},1032,["onClick"])])):c("",!0),o("p",{class:"text-sm text-gray-600 dark:text-gray-300"},[o("strong",null,"Expira:"),s(" "+m(B(e.fechaExpiracion)),1)])])];r(`<div class="p-4"${i}><p class="text-sm text-gray-600 dark:text-gray-300"${i}><strong${i}>Carrera:</strong> ${y(e.carrera)}</p><p class="text-sm text-gray-600 dark:text-gray-300"${i}><strong${i}>Jornada:</strong> ${y(e.jornada)}</p><p class="text-sm text-gray-600 dark:text-gray-300"${i}><strong${i}>Inscritos:</strong> ${y((null==(u=e.estudiantes)?void 0:u.length)||0)}</p>`),e.enlaceRegistro?(r(`<p class="text-sm text-gray-600 dark:text-gray-300 mt-2"${i}><strong${i}>Enlace de registro:</strong>`),r(x(P,{color:"blue",class:"ml-2 cursor-pointer",onClick:a=>J(e.enlaceRegistro)},{default:l(((e,a,r,t)=>{if(!a)return[s(" Copiar enlace ")];a(" Copiar enlace ")})),_:2},t,i)),r("</p>")):r("\x3c!----\x3e"),r(`<p class="text-sm text-gray-600 dark:text-gray-300"${i}><strong${i}>Expira:</strong> ${y(B(e.fechaExpiracion))}</p></div>`)})),_:2},r,t))})),a("\x3c!--]--\x3e</div>")):a(`<div class="text-center text-gray-600 dark:text-gray-400 py-8"${t}> No hay asignaturas creadas. </div>`)})),_:1},t)),r(x(R,{modelValue:q.value,"onUpdate:modelValue":e=>q.value=e},{default:l(((e,a,r,t)=>{if(!a)return[o(I,null,{header:l((()=>[o("h3",{class:"text-lg font-bold"},"Crear Nueva Asignatura")])),footer:l((()=>[o("div",{class:"flex justify-end space-x-2"},[o(E,{color:"gray",onClick:e=>q.value=!1},{default:l((()=>[s("Cancelar")])),_:1},8,["onClick"]),o(E,{color:"blue",loading:A.value,onClick:z$3},{default:l((()=>[s(m(A.value?"Creando...":"Crear Asignatura"),1)])),_:1},8,["loading"])])])),default:l((()=>[o(z,{state:S,onSubmit:z$3,class:"space-y-4"},{default:l((()=>[o(H,{label:"Nombre de la Asignatura",name:"nombre",required:""},{default:l((()=>[o(L,{modelValue:S.nombre,"onUpdate:modelValue":e=>S.nombre=e,placeholder:"Introduce el nombre de la asignatura"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),o(H,{label:"Carrera",name:"carrera",required:""},{default:l((()=>[o(L,{modelValue:S.carrera,"onUpdate:modelValue":e=>S.carrera=e,placeholder:"Introduce el nombre de la carrera"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),o(H,{label:"Jornada",name:"jornada",required:""},{default:l((()=>[o(O,{modelValue:S.jornada,"onUpdate:modelValue":e=>S.jornada=e,options:["Diurna","Nocturna"]},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["state"])])),_:1})];a(x(I,null,{header:l(((e,a,r,t)=>{if(!a)return[o("h3",{class:"text-lg font-bold"},"Crear Nueva Asignatura")];a(`<h3 class="text-lg font-bold"${t}>Crear Nueva Asignatura</h3>`)})),footer:l(((e,a,r,t)=>{if(!a)return[o("div",{class:"flex justify-end space-x-2"},[o(E,{color:"gray",onClick:e=>q.value=!1},{default:l((()=>[s("Cancelar")])),_:1},8,["onClick"]),o(E,{color:"blue",loading:A.value,onClick:z$3},{default:l((()=>[s(m(A.value?"Creando...":"Crear Asignatura"),1)])),_:1},8,["loading"])])];a(`<div class="flex justify-end space-x-2"${t}>`),a(x(E,{color:"gray",onClick:e=>q.value=!1},{default:l(((e,a,r,t)=>{if(!a)return[s("Cancelar")];a("Cancelar")})),_:1},r,t)),a(x(E,{color:"blue",loading:A.value,onClick:z$3},{default:l(((e,a,r,t)=>{if(!a)return[s(m(A.value?"Creando...":"Crear Asignatura"),1)];a(`${y(A.value?"Creando...":"Crear Asignatura")}`)})),_:1},r,t)),a("</div>")})),default:l(((e,a,r,t)=>{if(!a)return[o(z,{state:S,onSubmit:z$3,class:"space-y-4"},{default:l((()=>[o(H,{label:"Nombre de la Asignatura",name:"nombre",required:""},{default:l((()=>[o(L,{modelValue:S.nombre,"onUpdate:modelValue":e=>S.nombre=e,placeholder:"Introduce el nombre de la asignatura"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),o(H,{label:"Carrera",name:"carrera",required:""},{default:l((()=>[o(L,{modelValue:S.carrera,"onUpdate:modelValue":e=>S.carrera=e,placeholder:"Introduce el nombre de la carrera"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),o(H,{label:"Jornada",name:"jornada",required:""},{default:l((()=>[o(O,{modelValue:S.jornada,"onUpdate:modelValue":e=>S.jornada=e,options:["Diurna","Nocturna"]},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["state"])];a(x(z,{state:S,onSubmit:z$3,class:"space-y-4"},{default:l(((e,a,r,t)=>{if(!a)return[o(H,{label:"Nombre de la Asignatura",name:"nombre",required:""},{default:l((()=>[o(L,{modelValue:S.nombre,"onUpdate:modelValue":e=>S.nombre=e,placeholder:"Introduce el nombre de la asignatura"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),o(H,{label:"Carrera",name:"carrera",required:""},{default:l((()=>[o(L,{modelValue:S.carrera,"onUpdate:modelValue":e=>S.carrera=e,placeholder:"Introduce el nombre de la carrera"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),o(H,{label:"Jornada",name:"jornada",required:""},{default:l((()=>[o(O,{modelValue:S.jornada,"onUpdate:modelValue":e=>S.jornada=e,options:["Diurna","Nocturna"]},null,8,["modelValue","onUpdate:modelValue"])])),_:1})];a(x(H,{label:"Nombre de la Asignatura",name:"nombre",required:""},{default:l(((e,a,r,t)=>{if(!a)return[o(L,{modelValue:S.nombre,"onUpdate:modelValue":e=>S.nombre=e,placeholder:"Introduce el nombre de la asignatura"},null,8,["modelValue","onUpdate:modelValue"])];a(x(L,{modelValue:S.nombre,"onUpdate:modelValue":e=>S.nombre=e,placeholder:"Introduce el nombre de la asignatura"},null,r,t))})),_:1},r,t)),a(x(H,{label:"Carrera",name:"carrera",required:""},{default:l(((e,a,r,t)=>{if(!a)return[o(L,{modelValue:S.carrera,"onUpdate:modelValue":e=>S.carrera=e,placeholder:"Introduce el nombre de la carrera"},null,8,["modelValue","onUpdate:modelValue"])];a(x(L,{modelValue:S.carrera,"onUpdate:modelValue":e=>S.carrera=e,placeholder:"Introduce el nombre de la carrera"},null,r,t))})),_:1},r,t)),a(x(H,{label:"Jornada",name:"jornada",required:""},{default:l(((e,a,r,t)=>{if(!a)return[o(O,{modelValue:S.jornada,"onUpdate:modelValue":e=>S.jornada=e,options:["Diurna","Nocturna"]},null,8,["modelValue","onUpdate:modelValue"])];a(x(O,{modelValue:S.jornada,"onUpdate:modelValue":e=>S.jornada=e,options:["Diurna","Nocturna"]},null,r,t))})),_:1},r,t))})),_:1},r,t))})),_:1},r,t))})),_:1},t)),r("</div>")}}}),N=A.setup;A.setup=(e,a)=>{const r=g();return(r.modules||(r.modules=new Set)).add("components/SubjectPanel.vue"),N?N(e,a):void 0};const q={__name:"asignaturas",__ssrInlineRender:!0,setup:a=>(a,r,t,l)=>{r(`<div${f(e({class:"container mx-auto px-4 py-8"},l))} data-v-26fa017d><h1 class="text-3xl font-bold mb-6 text-gray-800 dark:text-gray-200" data-v-26fa017d>Panel Docente</h1>`),r(x(A,null,null,t)),r("</div>")}},S=q.setup;q.setup=(e,a)=>{const r=g();return(r.modules||(r.modules=new Set)).add("pages/teacher/asignaturas.vue"),S?S(e,a):void 0};const P=I(q,[["__scopeId","data-v-26fa017d"]]);export{P as default};
//# sourceMappingURL=asignaturas-DNjjUUf3.mjs.map
