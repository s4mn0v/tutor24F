import{d as e,c as r}from"../../../nitro/nitro.mjs";import{PrismaClient as t}from"@prisma/client";import{createClient as s}from"@supabase/supabase-js";import"mammoth";import"pdf.js-extract";import"node:http";import"node:https";import"@vercel/kv";import"@iconify/utils";import"consola/core";const o=s(process.env.SUPABASE_URL,process.env.SUPABASE_KEY),a=new t,i=e((async e=>{var t;const s=null==(t=e.context.params)?void 0:t.id;if(!s)throw r({statusCode:400,message:"Material ID is required."});const i=parseInt(s);if(isNaN(i))throw r({statusCode:400,message:"El ID del material no es v√°lido."});try{const e=await a.material.findUnique({where:{id:i}});if(!e)throw r({statusCode:404,message:"El material no existe."});const{error:t}=await o.storage.from("files").remove([e.url.split("/").pop()]);if(t)throw r({statusCode:500,message:"Error al eliminar el archivo de Supabase."});return await a.material.delete({where:{id:i}}),{success:!0}}catch(e){throw console.error(e),r({statusCode:500,message:"Error interno del servidor."})}}));export{i as default};
//# sourceMappingURL=_id_.delete.mjs.map
