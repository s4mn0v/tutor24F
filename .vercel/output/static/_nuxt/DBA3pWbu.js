import e from"./CqOQM_KY.js";import a from"./CprOuNih.js";import r from"./OhUZf6Dx.js";import t from"./Bs-PuSAp.js";import o from"./BN2OBxPi.js";import l from"./BpK8sBUR.js";import{f as s,r as i,B as n,g as d,j as u,h as c,o as g,i as m,b as p,k as v,t as b,F as h,m as y,C as x,w,y as f,e as k,_ as j,c as D}from"./hFqZFfy7.js";import{u as A}from"./DxHkahMw.js";import"./C9-cjxml.js";import"./CCWsANb-.js";import"./DHMDb2DJ.js";import"./D9V1fidf.js";import"./DmDc0Qph.js";import"./BdaDRl_o.js";import"./Bfxjojwb.js";import"./Ch5OrHHS.js";import"./CHOj1P8S.js";import"./DMycwmPB.js";import"./CEcqJ5JC.js";import"./DbuPMTfp.js";import"./BvCfb3ib.js";import"./D7unn5Ia.js";import"./BE7Nko66.js";import"./chI-DJON.js";import"./Yfl05yA4.js";import"./DNRP4idu.js";import"./CkVD2Uqn.js";import".prisma/client/index-browser";const E={class:"min-h-screen bg-white dark:bg-transparent"},C={class:"max-w-7xl mx-auto bg-white dark:bg-zinc-800 rounded-xl shadow-lg overflow-hidden"},I={class:"flex flex-col lg:flex-row"},S={class:"w-full lg:w-2/3 p-4"},V={class:"flex justify-between items-center mb-6"},M={class:"text-xl lg:text-2xl font-bold text-gray-800 dark:text-white"},_={class:"grid grid-cols-7 gap-1 mb-2"},T={class:"grid grid-cols-7 gap-1"},z=["onClick","disabled"],F={class:"w-full lg:w-1/3 border-t lg:border-t-0 lg:border-l border-gray-200 dark:border-gray-700 p-4"},q={class:"overflow-y-auto max-h-[calc(100vh-16rem)]"},B={key:0,class:"space-y-2"},J=["onClick"],L={class:"font-semibold text-gray-800 dark:text-white"},O={class:"text-sm text-gray-600 dark:text-gray-400"},U={class:"text-xs text-gray-500 dark:text-gray-500 mt-1"},N={class:"text-xs text-gray-500 dark:text-gray-500 mt-1"},R={key:1,class:"text-gray-600 dark:text-gray-400"},Y={class:"bg-white dark:bg-zinc-800 rounded-lg p-6"},P={class:"flex justify-end space-x-2"},$=j(s({__name:"Calendar",setup(s){const{token:j,refreshToken:D}=A(),$=i(new Date),G=i(null),H=i(!1),K=i(!1),Z=i([]),Q=i([]),W=i(null),X=i({title:"",description:"",asignaturaId:0,importance:""}),ee=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],ae=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],re=n((()=>ae[$.value.getMonth()])),te=n((()=>$.value.getFullYear())),oe=n((()=>{const e=$.value.getFullYear(),a=$.value.getMonth(),r=new Date(e,a,1),t=new Date(e,a+1,0).getDate(),o=r.getDay(),l=[];for(let i=0;i<o;i++){const r=new Date(e,a,-o+i+1);l.push({date:r,isCurrentMonth:!1,isToday:ue(r)})}for(let i=1;i<=t;i++){const r=new Date(e,a,i);l.push({date:r,isCurrentMonth:!0,isToday:ue(r)})}const s=42-l.length;for(let i=1;i<=s;i++){const r=new Date(e,a+1,i);l.push({date:r,isCurrentMonth:!1,isToday:ue(r)})}return l})),le=n((()=>Q.value.map((e=>({label:e.nombre,value:e.id}))))),se=[{label:"Baja",value:"BAJA"},{label:"Media",value:"MEDIA"},{label:"Alta",value:"ALTA"}],ie=()=>{$.value=new Date($.value.getFullYear(),$.value.getMonth()-1,1)},ne=()=>{$.value=new Date($.value.getFullYear(),$.value.getMonth()+1,1)},de=e=>G.value&&e.toDateString()===G.value.toDateString(),ue=e=>{const a=new Date;return e.toDateString()===a.toDateString()},ce=e=>{const a=new Date;return a.setHours(0,0,0,0),e>=a},ge=e=>{switch(e){case"BAJA":return"border-l-4 border-green-500 bg-green-50 dark:bg-green-900";case"MEDIA":return"border-l-4 border-yellow-500 bg-yellow-50 dark:bg-yellow-900";case"ALTA":return"border-l-4 border-red-500 bg-red-50 dark:bg-red-900";default:return"border-l-4 border-gray-500 bg-zinc-50 dark:bg-zinc-800"}},me=(e,a)=>{W.value={message:e,type:a},setTimeout((()=>{W.value=null}),5e3)},pe=async(e,a={})=>{const r={...a.headers,Authorization:`Bearer ${j.value}`,"Content-Type":"application/json"};try{const t=await fetch(e,{...a,headers:r});return 401===t.status?(await D(),r.Authorization=`Bearer ${j.value}`,fetch(e,{...a,headers:r})):t}catch(t){throw t}},ve=async()=>{try{const e=await pe("/api/docente/eventos");if(!e.ok)throw new Error("Error al obtener recordatorios");const a=await e.json();Array.isArray(a.eventos)?Z.value=a.eventos.map((e=>({id:e.id,titulo:e.title,descripcion:e.description,fecha:e.date,asignaturaId:e.asignatura.id,importancia:e.importance}))):Z.value=[],Array.isArray(a.asignaturas)?Q.value=a.asignaturas:Q.value=[]}catch(e){me("Error al cargar los datos. Por favor, intenta de nuevo más tarde.","error")}},be=async()=>{if(G.value&&X.value.title&&X.value.asignaturaId&&X.value.importance){K.value=!0;try{const e=await pe("/api/docente/eventos",{method:"POST",body:JSON.stringify({title:X.value.title,description:X.value.description,date:G.value.toISOString(),asignaturaId:X.value.asignaturaId,importance:X.value.importance})});if(!e.ok){const a=await e.json();throw new Error(a.message||"Error al crear recordatorio")}await ve(),H.value=!1,X.value={title:"",description:"",asignaturaId:0,importance:""},me("Recordatorio creado exitosamente","success")}catch(e){me("Error al crear el recordatorio: "+e.message,"error")}finally{K.value=!1}}else me("Por favor, completa todos los campos requeridos.","error")},he=e=>{const a=Q.value.find((a=>a.id===e));return a?a.nombre:"Desconocida"};return d(ve),u($,ve),(s,i)=>{const n=e,d=a,u=r,j=t,D=o,A=l;return g(),c("div",E,[m("div",C,[m("div",I,[m("div",S,[m("div",V,[m("h2",M,b(re.value)+" "+b(te.value),1),m("div",{class:"flex space-x-2"},[m("button",{onClick:ie,class:"p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-900 transition-colors"},i[6]||(i[6]=[m("i",{class:"i-heroicons-chevron-left-20-solid w-5 h-5 text-gray-600 dark:text-gray-300"},null,-1)])),m("button",{onClick:ne,class:"p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors"},i[7]||(i[7]=[m("i",{class:"i-heroicons-chevron-right-20-solid w-5 h-5 text-gray-600 dark:text-gray-300"},null,-1)]))])]),m("div",_,[(g(),c(h,null,y(ee,(e=>m("div",{key:e,class:"text-center font-semibold text-gray-600 dark:text-gray-400 text-xs lg:text-sm"},b(e),1))),64))]),m("div",T,[(g(!0),c(h,null,y(oe.value,(({date:e,isCurrentMonth:a,isToday:r})=>(g(),c("button",{key:e.toISOString(),onClick:a=>(e=>{G.value=e,ce(e)&&(H.value=!0)})(e),class:x(["p-1 w-full aspect-square rounded-lg text-center transition-colors text-xs lg:text-sm",a?"hover:bg-blue-100 dark:hover:bg-blue-900":"text-gray-400 dark:text-gray-600",r?"bg-blue-200 dark:bg-blue-800 font-bold":"",de(e)?"bg-blue-500 text-white":"",ce(e)?"cursor-pointer":"cursor-not-allowed"]),disabled:!ce(e)},[m("span",null,b(e.getDate()),1)],10,z)))),128))])]),m("div",F,[i[9]||(i[9]=m("h3",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-white"},"Recordatorios",-1)),m("div",q,[Z.value.length?(g(),c("ul",B,[(g(!0),c(h,null,y(Z.value,(e=>{return g(),c("li",{key:e.id,class:x(["p-3 rounded-lg mb-2 relative",ge(e.importancia)])},[m("button",{onClick:a=>(async e=>{try{const a=await pe(`/api/docente/eventos/${e}`,{method:"DELETE"});if(!a.ok)throw new Error("Error al eliminar recordatorio");const r=await a.json();if(!r.success)throw new Error(r.message||"Error al eliminar el recordatorio");await ve(),me("Recordatorio eliminado exitosamente","success")}catch(a){me("Error al eliminar el recordatorio: "+a.message,"error")}})(e.id),class:"absolute top-2 right-2 text-red-500 hover:text-red-700 dark:hover:text-red-400","aria-label":"Eliminar recordatorio"},i[8]||(i[8]=[m("i",{class:"i-heroicons-trash-20-solid w-5 h-5"},null,-1)]),8,J),m("div",null,[m("h4",L,b(e.titulo),1),m("p",O,b(e.descripcion),1),m("p",U," Fecha: "+b((a=new Date(e.fecha),a.toLocaleDateString("es",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))),1),m("p",N," Asignatura: "+b(he(e.asignaturaId)),1)])],2);var a})),128))])):(g(),c("p",R,"No hay recordatorios."))])])])]),p(A,{modelValue:H.value,"onUpdate:modelValue":i[5]||(i[5]=e=>H.value=e)},{default:w((()=>[m("div",Y,[i[12]||(i[12]=m("h3",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-white"},"Nuevo Recordatorio",-1)),m("form",{onSubmit:f(be,["prevent"]),class:"space-y-4"},[p(d,{label:"Título",name:"title"},{default:w((()=>[p(n,{modelValue:X.value.title,"onUpdate:modelValue":i[0]||(i[0]=e=>X.value.title=e),placeholder:"Título del recordatorio",required:""},null,8,["modelValue"])])),_:1}),p(d,{label:"Descripción",name:"description"},{default:w((()=>[p(u,{modelValue:X.value.description,"onUpdate:modelValue":i[1]||(i[1]=e=>X.value.description=e),placeholder:"Descripción del recordatorio"},null,8,["modelValue"])])),_:1}),p(d,{label:"Asignatura",name:"asignatura"},{default:w((()=>[p(j,{modelValue:X.value.asignaturaId,"onUpdate:modelValue":i[2]||(i[2]=e=>X.value.asignaturaId=e),options:le.value,placeholder:"Selecciona una asignatura",required:""},null,8,["modelValue","options"])])),_:1}),p(d,{label:"Importancia",name:"importance"},{default:w((()=>[p(j,{modelValue:X.value.importance,"onUpdate:modelValue":i[3]||(i[3]=e=>X.value.importance=e),options:se,placeholder:"Selecciona la importancia",required:""},null,8,["modelValue"])])),_:1}),m("div",P,[p(D,{color:"gray",onClick:i[4]||(i[4]=e=>H.value=!1)},{default:w((()=>i[10]||(i[10]=[k("Cancelar")]))),_:1}),p(D,{color:"primary",type:"submit",loading:K.value},{default:w((()=>i[11]||(i[11]=[k("Guardar")]))),_:1},8,["loading"])])],32)])])),_:1},8,["modelValue"]),W.value?(g(),c("div",{key:0,class:x(["fixed bottom-4 right-4 p-4 rounded-lg shadow-lg transition-opacity duration-300",{"bg-green-500":"success"===W.value.type,"bg-red-500":"error"===W.value.type,"bg-blue-500":"info"===W.value.type,"bg-yellow-500":"warning"===W.value.type}])},b(W.value.message),3)):v("",!0)])}}}),[["__scopeId","data-v-002d6c54"]]),G=s({__name:"calendar",setup:e=>(e,a)=>(g(),D($))});export{G as default};
