import e from"./MFsz-r7O.js";import{_ as t,h as a,o as r,i as s,k as i,t as l,F as o,m as n,b as d,w as c,e as u,u as h,I as m}from"./y4QvXspP.js";import"./BEP5_JP-.js";import"./D5749dPv.js";import"./D0xtSe3C.js";import"./Bfxjojwb.js";import"./Ch5OrHHS.js";import"./BsUv8T9A.js";import"./CcWMAPI5.js";import"./CHOj1P8S.js";import"./CGY6ERjo.js";import".prisma/client/index-browser";const g={class:"flex justify-center p-4"},p={class:"p-6 max-w-2xl w-full bg-gradient-to-br from-blue-50 to-blue-100 dark:from-zinc-700 dark:to-zinc-800 shadow-md rounded-md"},b={for:"fileInput",class:"block w-full border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg py-8 text-center cursor-pointer hover:border-blue-400 transition-colors"},f={key:0,class:"text-gray-500 dark:text-gray-300"},y={key:1,class:"text-gray-700 dark:text-gray-200"},x={class:"font-medium"},k=["disabled"],v={key:0,class:"mt-4 p-3 bg-red-100 text-red-700 rounded"},w={key:1,class:"mt-4 p-3 bg-green-100 text-green-700 rounded"},j={class:"mt-6"},F={key:0},E={class:"divide-y divide-gray-200 dark:divide-gray-700"},A=["href"],C={class:"text-sm text-gray-500 dark:text-gray-400"},M={key:1,class:"mt-4 text-center text-gray-500 dark:text-gray-400"};const S=t({props:{idAsignatura:{type:Number,required:!0}},data:()=>({selectedFile:null,uploading:!1,success:!1,error:null,materiales:[],deleting:null}),mounted(){this.fetchMateriales()},methods:{handleFileChange(e){this.selectedFile=e.target.files[0]},async fetchMateriales(){try{const e=await fetch(`/api/materials/${this.idAsignatura}`);if(!e.ok)throw new Error("Error al obtener los materiales.");this.materiales=await e.json()}catch(e){this.error=e.message}},async uploadFile(){if(!this.selectedFile)return;this.uploading=!0,this.success=!1,this.error=null;const e=new FormData;e.append("file",this.selectedFile),e.append("idAsignatura",this.idAsignatura.toString());try{const t=await fetch("/api/files/upload",{method:"POST",body:e});if(!t.ok){const e=await t.json();throw new Error(e.message||"Error al subir el archivo.")}this.success=!0,await this.fetchMateriales()}catch(t){this.error=t.message}finally{this.uploading=!1}},async deleteMaterial(e){this.deleting=e;try{const t=await fetch(`/api/materials/${e}`,{method:"DELETE"});if(!t.ok){const e=await t.json();throw new Error(e.message||"Error al eliminar el archivo.")}await this.fetchMateriales()}catch(t){this.error=t.message}finally{this.deleting=null}}}},[["render",function(t,h,m,S,_,I){const z=e;return r(),a("div",g,[s("div",p,[h[6]||(h[6]=s("h2",{class:"text-2xl font-bold mb-6 text-gray-800 dark:text-gray-100"},"Subir Archivo",-1)),s("label",b,[_.selectedFile?(r(),a("div",y,[h[3]||(h[3]=s("span",{class:"block mb-2"},"Archivo seleccionado:",-1)),s("span",x,l(_.selectedFile.name),1)])):(r(),a("div",f,h[2]||(h[2]=[s("span",{class:"block mb-2"},"Arrastra y suelta un archivo aquí",-1),s("span",{class:"text-sm"},"O haz clic para seleccionar uno",-1)]))),s("input",{id:"fileInput",type:"file",class:"hidden",onChange:h[0]||(h[0]=(...e)=>I.handleFileChange&&I.handleFileChange(...e))},null,32)]),s("button",{onClick:h[1]||(h[1]=(...e)=>I.uploadFile&&I.uploadFile(...e)),disabled:!_.selectedFile||_.uploading,class:"mt-4 w-full bg-green-500 hover:bg-green-600 disabled:bg-green-300 text-white font-semibold py-2 px-4 rounded transition-colors"},l(_.uploading?"Subiendo...":"Subir Archivo"),9,k),_.error?(r(),a("div",v," Error: "+l(_.error),1)):i("",!0),_.success?(r(),a("div",w," Archivo subido con éxito. ")):i("",!0),s("div",j,[h[5]||(h[5]=s("h3",{class:"text-xl font-bold mb-3 text-gray-800 dark:text-gray-100"},"Archivos Subidos:",-1)),_.materiales.length>0?(r(),a("div",F,[s("ul",E,[(r(!0),a(o,null,n(_.materiales,(e=>(r(),a("li",{key:e.id,class:"py-3 flex items-center justify-between"},[s("div",null,[s("a",{href:e.url,target:"_blank",class:"text-blue-600 dark:text-blue-400 hover:underline font-medium"},l(e.nombre),9,A),s("p",C,"("+l(e.tipo)+")",1)]),d(z,{onClick:t=>I.deleteMaterial(e.id),color:"red",variant:"ghost",icon:"i-heroicons-trash",loading:_.deleting===e.id},{default:c((()=>h[4]||(h[4]=[u(" Eliminar ")]))),_:2},1032,["onClick","loading"])])))),128))])])):(r(),a("div",M," No hay archivos subidos aún. "))])])])}]]),_={__name:"[id]",setup(e){const t=h(),s=parseInt(t.params.id);return(e,t)=>{const i=S;return r(),a("div",null,[d(i,{"id-asignatura":m(s)},null,8,["id-asignatura"])])}}};export{_ as default};
