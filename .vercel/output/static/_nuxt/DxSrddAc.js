import a from"./MFsz-r7O.js";import e from"./D7aGgoFn.js";import r from"./D7s0IBLH.js";import t from"./B7FZW29-.js";import o from"./CHXTBSQj.js";import l from"./fHUgzazi.js";import s from"./CwmU73O8.js";import n from"./B3_2zXUT.js";import i from"./Ban32Nb9.js";import{f as c,r as d,J as u,g as m,h as p,o as g,b as f,w as x,i as j,e as b,F as y,m as h,c as v,k,t as w,y as C,K as _,_ as E}from"./y4QvXspP.js";import{u as V}from"./DGFe1SEZ.js";import"./BEP5_JP-.js";import"./D5749dPv.js";import"./D0xtSe3C.js";import"./Bfxjojwb.js";import"./Ch5OrHHS.js";import"./BsUv8T9A.js";import"./CcWMAPI5.js";import"./CHOj1P8S.js";import"./N1GbHz2C.js";import"./BmYt0hqU.js";import"./Bg0KYS7B.js";import"./C5xfyGX2.js";import"./CLukktBK.js";import"./E-EL6i1g.js";import"./b_2Iuj5n.js";import"./B_0YXuDZ.js";import"./chI-DJON.js";import"./Yfl05yA4.js";import"./B3WgecHe.js";import"./CGY6ERjo.js";import".prisma/client/index-browser";const $={class:"bg-transparent p-4 sm:p-6"},A={class:"flex flex-col sm:flex-row justify-between items-center mb-6 space-y-4 sm:space-y-0"},N={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6"},I={class:"text-lg sm:text-xl font-bold text-center text-blue-600 uppercase"},S={class:"p-4"},T={class:"text-sm text-gray-600 dark:text-gray-300"},q={class:"text-sm text-gray-600 dark:text-gray-300"},D={class:"text-sm text-gray-600 dark:text-gray-300"},P={key:0,class:"text-sm text-gray-600 dark:text-gray-300 mt-2"},z={class:"text-sm text-gray-600 dark:text-gray-300"},U={class:"flex justify-between items-center"},B={key:1,class:"text-center text-gray-600 dark:text-gray-400 py-8"},H={class:"flex justify-end space-x-2"},J=c({__name:"SubjectPanel",setup(c){const E=_(),J=V(),O=d(!1),R=d([]),L=d(!1),F=u({nombre:"",carrera:"",jornada:""}),G=async()=>{try{const a=localStorage.getItem("token");if(!a)throw new Error("No autenticado");const e=await $fetch("/api/asignaturas",{headers:{Authorization:`Bearer ${a}`}});R.value=e}catch(a){J.add({title:"Error al cargar las asignaturas",color:"red"})}},K=async()=>{if(F.nombre&&F.carrera&&F.jornada){O.value=!0;try{const a=localStorage.getItem("token");if(!a)throw new Error("No autenticado");await $fetch("/api/asignaturas/create",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:{nombre:F.nombre,carrera:F.carrera,jornada:F.jornada}})&&(J.add({title:"Asignatura creada exitosamente!",color:"green"}),F.nombre="",F.carrera="",F.jornada="",L.value=!1,await G())}catch(a){J.add({title:a instanceof Error?a.message:"Hubo un error al crear la asignatura",color:"red"})}finally{O.value=!1}}else J.add({title:"Por favor, completa todos los campos",color:"yellow"})};return m((()=>{G()})),(c,d)=>{const u=a,m=e,_=r,V=t,Z=o,M=l,Q=s,W=n,X=i;return g(),p("div",$,[f(V,null,{default:x((()=>[j("div",A,[d[7]||(d[7]=j("h2",{class:"text-2xl font-bold text-blue-600"},"Asignaturas",-1)),f(u,{color:"blue",onClick:d[0]||(d[0]=a=>L.value=!0),icon:"i-heroicons-plus"},{default:x((()=>d[6]||(d[6]=[b(" Crear Asignatura ")]))),_:1})]),R.value.length>0?(g(),p("div",N,[(g(!0),p(y,null,h(R.value,(a=>(g(),v(_,{key:a.id,class:"bg-white/80 dark:bg-gray-800/80 hover:shadow-lg transition-shadow duration-300 cursor-pointer",onClick:e=>{return r=a.id,void E.push(`/teacher/asignatura/${r}`);var r}},{header:x((()=>[j("h3",I,w(a.nombre),1)])),footer:x((()=>[j("div",U,[f(u,{onClick:C((e=>(async a=>{try{const e=await $fetch(`/api/asignaturas/${a}/generate-link`,{method:"POST"});e&&e.enlaceRegistro&&(J.add({title:"Enlace generado exitosamente! Tiene una duración de 20 minutos.",color:"green"}),await G())}catch(e){J.add({title:"Hubo un error al generar el enlace",color:"red"})}})(a.id)),["stop"]),color:"blue",size:"sm"},{default:x((()=>d[14]||(d[14]=[b(" Generar Enlace ")]))),_:2},1032,["onClick"]),f(u,{onClick:C((e=>(async a=>{if(confirm("¿Estás seguro de que deseas eliminar esta asignatura?"))try{await $fetch(`/api/asignaturas/${a}`,{method:"DELETE"}),J.add({title:"Asignatura eliminada exitosamente",color:"green"}),await G()}catch(e){J.add({title:"Hubo un error al eliminar la asignatura",color:"red"})}})(a.id)),["stop"]),color:"red",size:"sm"},{default:x((()=>d[15]||(d[15]=[b(" Eliminar ")]))),_:2},1032,["onClick"])])])),default:x((()=>{var e,r;return[j("div",S,[j("p",T,[d[8]||(d[8]=j("strong",null,"Carrera:",-1)),b(" "+w(a.carrera),1)]),j("p",q,[d[9]||(d[9]=j("strong",null,"Jornada:",-1)),b(" "+w(a.jornada),1)]),j("p",D,[d[10]||(d[10]=j("strong",null,"Inscritos:",-1)),b(" "+w((null==(e=a.estudiantes)?void 0:e.length)||0),1)]),a.enlaceRegistro?(g(),p("p",P,[d[12]||(d[12]=j("strong",null,"Enlace de registro:",-1)),f(m,{color:"blue",class:"ml-2 cursor-pointer",onClick:C((e=>{return r=a.enlaceRegistro,navigator.clipboard.writeText(`${window.location.origin}/inscribir?enlace=${r}`),void J.add({title:"Enlace copiado al portapapeles!",color:"green"});var r}),["stop"])},{default:x((()=>d[11]||(d[11]=[b(" Copiar enlace ")]))),_:2},1032,["onClick"])])):k("",!0),j("p",z,[d[13]||(d[13]=j("strong",null,"Expira:",-1)),b(" "+w((r=a.fechaExpiracion,r?new Date(r).toLocaleString():"N/A")),1)])])]})),_:2},1032,["onClick"])))),128))])):(g(),p("div",B," No hay asignaturas creadas. "))])),_:1}),f(X,{modelValue:L.value,"onUpdate:modelValue":d[5]||(d[5]=a=>L.value=a)},{default:x((()=>[f(_,null,{header:x((()=>d[16]||(d[16]=[j("h3",{class:"text-lg font-bold"},"Crear Nueva Asignatura",-1)]))),footer:x((()=>[j("div",H,[f(u,{color:"gray",onClick:d[4]||(d[4]=a=>L.value=!1)},{default:x((()=>d[17]||(d[17]=[b("Cancelar")]))),_:1}),f(u,{color:"blue",loading:O.value,onClick:K},{default:x((()=>[b(w(O.value?"Creando...":"Crear Asignatura"),1)])),_:1},8,["loading"])])])),default:x((()=>[f(W,{state:F,onSubmit:K,class:"space-y-4"},{default:x((()=>[f(M,{label:"Nombre de la Asignatura",name:"nombre",required:""},{default:x((()=>[f(Z,{modelValue:F.nombre,"onUpdate:modelValue":d[1]||(d[1]=a=>F.nombre=a),placeholder:"Introduce el nombre de la asignatura"},null,8,["modelValue"])])),_:1}),f(M,{label:"Carrera",name:"carrera",required:""},{default:x((()=>[f(Z,{modelValue:F.carrera,"onUpdate:modelValue":d[2]||(d[2]=a=>F.carrera=a),placeholder:"Introduce el nombre de la carrera"},null,8,["modelValue"])])),_:1}),f(M,{label:"Jornada",name:"jornada",required:""},{default:x((()=>[f(Q,{modelValue:F.jornada,"onUpdate:modelValue":d[3]||(d[3]=a=>F.jornada=a),options:["Diurna","Nocturna"]},null,8,["modelValue"])])),_:1})])),_:1},8,["state"])])),_:1})])),_:1},8,["modelValue"])])}}}),O={class:"container mx-auto px-4 py-8"},R=E({__name:"asignaturas",setup:a=>(a,e)=>(g(),p("div",O,[e[0]||(e[0]=j("h1",{class:"text-3xl font-bold mb-6 text-gray-800 dark:text-gray-200"},"Panel Docente",-1)),f(J)]))},[["__scopeId","data-v-26fa017d"]]);export{R as default};
