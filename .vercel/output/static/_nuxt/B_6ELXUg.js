import a from"./BEP5_JP-.js";import e from"./D7s0IBLH.js";import{f as t,r as s,g as r,h as l,o as i,b as o,w as n,i as c,F as u,e as d,t as m,c as g,j as v,k as p,l as b}from"./y4QvXspP.js";import f from"./CHXTBSQj.js";import h from"./MFsz-r7O.js";import j from"./BkS5hAU1.js";import x from"./qpKX9jtC.js";import y from"./LVTZ1MR-.js";import k from"./Ban32Nb9.js";import"./D5749dPv.js";import"./BsUv8T9A.js";import"./CGY6ERjo.js";import".prisma/client/index-browser";import"./N1GbHz2C.js";import"./CcWMAPI5.js";import"./D0xtSe3C.js";import"./Bfxjojwb.js";import"./Ch5OrHHS.js";import"./CHOj1P8S.js";import"./Cq5CFOCe.js";import"./BFnrRPax.js";import"./E-EL6i1g.js";import"./b_2Iuj5n.js";import"./CLukktBK.js";import"./DSObW8YX.js";import"./B_t2eSKp.js";import"./rGk_6fuN.js";import"./B3WgecHe.js";import"./C3eNCTn-.js";import"./BmYt0hqU.js";import"./BJht0Fqd.js";import"./BQWut4pg.js";import"./Bg0KYS7B.js";import"./C5xfyGX2.js";import"./B_0YXuDZ.js";import"./chI-DJON.js";import"./Yfl05yA4.js";const _={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"},A={class:"flex items-center gap-2"},w={class:"text-3xl font-bold"},M={class:"flex items-center gap-2"},C={class:"text-3xl font-bold"},E={class:"flex items-center gap-2"},z={class:"text-3xl font-bold"},V={class:"flex items-center gap-2"},$={class:"text-3xl font-bold"},S={class:"flex items-center gap-2"},N={class:"text-3xl font-bold"},P={class:"flex items-center gap-2"},D={class:"text-3xl font-bold"},L=t({__name:"EstadisticaAsignaturas",setup(t){const g=s({subjects:0,students:0,average:0,activeSubjects:0,inactiveSubjects:0,averageMaterials:0}),v=s({subjects:!0,students:!0,average:!0,activeSubjects:!0,inactiveSubjects:!0,averageMaterials:!0});return r((async()=>{try{const[a,e,t,s,r]=await Promise.all([$fetch("/api/stats/subjects/count"),$fetch("/api/stats/students/count"),$fetch("/api/stats/students/average"),$fetch("/api/stats/asignaturas/active-inactive"),$fetch("/api/stats/materials/average")]);g.value={subjects:a.count,students:e.count,average:Number(t.average),activeSubjects:s.active,inactiveSubjects:s.inactive,averageMaterials:Number(r.averageMaterials)},v.value={subjects:!1,students:!1,average:!1,activeSubjects:!1,inactiveSubjects:!1,averageMaterials:!1}}catch(a){}})),(t,s)=>{const r=a,p=e;return i(),l("div",_,[o(p,{class:"bg-gradient-to-br from-blue-200 to-blue-400 dark:from-zinc-800 dark:to-zinc-900 shadow-md rounded-md"},{header:n((()=>[c("div",A,[o(r,{name:"i-heroicons-book-open",class:"text-primary text-xl"}),s[0]||(s[0]=c("h3",{class:"font-semibold"},"Asignaturas",-1))])])),default:n((()=>[c("div",w,[v.value.subjects?(i(),l(u,{key:0},[d("Cargando...")],64)):(i(),l(u,{key:1},[d(m(g.value.subjects),1)],64))])])),_:1}),o(p,{class:"bg-gradient-to-br from-blue-200 to-blue-400 dark:from-zinc-800 dark:to-zinc-900 shadow-md rounded-md"},{header:n((()=>[c("div",M,[o(r,{name:"i-heroicons-user-group",class:"text-green-500 text-xl"}),s[1]||(s[1]=c("h3",{class:"font-semibold"},"Estudiantes",-1))])])),default:n((()=>[c("div",C,[v.value.students?(i(),l(u,{key:0},[d("Cargando...")],64)):(i(),l(u,{key:1},[d(m(g.value.students),1)],64))])])),_:1}),o(p,{class:"bg-gradient-to-br from-blue-200 to-blue-400 dark:from-zinc-800 dark:to-zinc-900 shadow-md rounded-md"},{header:n((()=>[c("div",E,[o(r,{name:"i-heroicons-chart-bar",class:"text-purple-500 text-xl"}),s[2]||(s[2]=c("h3",{class:"font-semibold"},"Promedio por asignatura",-1))])])),default:n((()=>[c("div",z,[v.value.average?(i(),l(u,{key:0},[d("Cargando...")],64)):(i(),l(u,{key:1},[d(m(g.value.average),1)],64))])])),_:1}),o(p,{class:"bg-gradient-to-br from-blue-200 to-blue-400 dark:from-zinc-800 dark:to-zinc-900 shadow-md rounded-md"},{header:n((()=>[c("div",V,[o(r,{name:"i-heroicons-check-circle",class:"text-green-500 text-xl"}),s[3]||(s[3]=c("h3",{class:"font-semibold"},"Asignaturas Activas",-1))])])),default:n((()=>[c("div",$,[v.value.activeSubjects?(i(),l(u,{key:0},[d("Cargando...")],64)):(i(),l(u,{key:1},[d(m(g.value.activeSubjects),1)],64))])])),_:1}),o(p,{class:"bg-gradient-to-br from-blue-200 to-blue-400 dark:from-zinc-800 dark:to-zinc-900 shadow-md rounded-md"},{header:n((()=>[c("div",S,[o(r,{name:"i-heroicons-x-circle",class:"text-red-500 text-xl"}),s[4]||(s[4]=c("h3",{class:"font-semibold"},"Asignaturas Inactivas",-1))])])),default:n((()=>[c("div",N,[v.value.inactiveSubjects?(i(),l(u,{key:0},[d("Cargando...")],64)):(i(),l(u,{key:1},[d(m(g.value.inactiveSubjects),1)],64))])])),_:1}),o(p,{class:"bg-gradient-to-br from-blue-200 to-blue-400 dark:from-zinc-800 dark:to-zinc-900 shadow-md rounded-md"},{header:n((()=>[c("div",P,[o(r,{name:"i-heroicons-document-text",class:"text-blue-500 text-xl"}),s[5]||(s[5]=c("h3",{class:"font-semibold"},"Prom. de Materiales",-1))])])),default:n((()=>[c("div",D,[v.value.averageMaterials?(i(),l(u,{key:0},[d("Cargando...")],64)):(i(),l(u,{key:1},[d(m(g.value.averageMaterials),1)],64))])])),_:1})])}}}),U={key:0},T={key:1},q={key:2},O={class:"flex justify-end gap-3"},B=t({__name:"DeleteAsignaturaModal",props:{asignatura:{type:Object,default:null},selectedAsignaturas:{type:Array,default:()=>[]}},emits:["confirm"],setup(a,{expose:t,emit:r}){const u=a,v=r,p=s(!1),b=()=>{p.value=!1},f=()=>{u.asignatura?v("confirm",u.asignatura):u.selectedAsignaturas.length>0&&v("confirm",u.selectedAsignaturas),b()};return t({openModal:()=>{p.value=!0},closeModal:b}),(t,s)=>{const r=h,u=e,v=k;return i(),g(v,{modelValue:p.value,"onUpdate:modelValue":s[0]||(s[0]=a=>p.value=a)},{default:n((()=>[o(u,null,{header:n((()=>s[1]||(s[1]=[c("h3",{class:"text-lg font-semibold"},"Confirmar Eliminación de Asignatura",-1)]))),footer:n((()=>[c("div",O,[o(r,{color:"gray",onClick:b},{default:n((()=>s[6]||(s[6]=[d("Cancelar")]))),_:1}),o(r,{color:"red",onClick:f},{default:n((()=>s[7]||(s[7]=[d("Eliminar")]))),_:1})])])),default:n((()=>[a.asignatura?(i(),l("p",U,[s[2]||(s[2]=d("¿Estás seguro de eliminar la asignatura ")),c("strong",null,m(a.asignatura.nombre),1),s[3]||(s[3]=d("?"))])):a.selectedAsignaturas.length>0?(i(),l("p",T,[s[4]||(s[4]=d(" ¿Estás seguro de eliminar las ")),c("strong",null,m(a.selectedAsignaturas.length),1),s[5]||(s[5]=d(" asignaturas seleccionadas? "))])):(i(),l("p",q,"No se ha seleccionado ninguna asignatura para eliminar."))])),_:1})])),_:1},8,["modelValue"])}}}),F={class:"flex justify-end px-3 py-3.5 border-t border-gray-200 dark:border-gray-700"},G=t({__name:"TableSubjects",setup(a){const t=s([]),r=s(""),l=s(1),u=s(50),d=s(!1),m=s([]),b=s(0),k=s(null),_=s(null),A=[{key:"nombre",label:"Nombre"},{key:"carrera",label:"Carrera"},{key:"docente.nombre",label:"Docente"},{key:"jornada",label:"Jornada"},{key:"actions",label:"Acciones"}],w=async()=>{d.value=!0;const a=await $fetch("/api/admin/asignaturas",{query:{page:l.value,limit:u.value,search:r.value.toLocaleLowerCase()}}),{asignaturas:e,total:t}=a;m.value=e,b.value=t,d.value=!1};v([l,r],w,{immediate:!0});const M=a=>[[{label:"Eliminar",icon:"i-heroicons-trash-20-solid",click:()=>{var e;k.value=a,null==(e=_.value)||e.openModal()}}]],C=async a=>{try{if(Array.isArray(a)){const e=a.map((a=>a.id));await Promise.all(e.map((a=>$fetch(`/api/admin/asignaturas/${a}`,{method:"DELETE"}))))}else await $fetch(`/api/admin/asignaturas/${a.id}`,{method:"DELETE"});l.value=1,w()}catch(e){}},E=()=>{var a;t.value.length>0&&(null==(a=_.value)||a.openModal())};return(a,s)=>{const v=f,w=h,z=j,V=x,$=y,S=e;return i(),g(S,null,{default:n((()=>[o(v,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=a=>r.value=a),placeholder:"Buscar por nombre, carrera o docente..."},null,8,["modelValue"]),t.value.length>0?(i(),g(w,{key:0,disabled:0===t.value.length,onClick:E,color:"red",variant:"outline",class:"mt-4",icon:"i-heroicons-trash-20-solid",title:"Eliminar seleccionados"},null,8,["disabled"])):p("",!0),s[3]||(s[3]=c("br",null,null,-1)),o(V,{rows:m.value,columns:A,loading:d.value,"loading-state":{icon:"i-heroicons-arrow-path-20-solid",label:"Loading..."},progress:{color:"primary",animation:"carousel"},"empty-state":{icon:"i-heroicons-circle-stack-20-solid",label:"No items."},modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=a=>t.value=a)},{"actions-data":n((({row:a})=>[o(z,{items:M(a)},{default:n((()=>[o(w,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal-20-solid"})])),_:2},1032,["items"])])),_:1},8,["rows","loading","modelValue"]),c("div",F,[o($,{modelValue:l.value,"onUpdate:modelValue":s[2]||(s[2]=a=>l.value=a),"page-count":u.value,total:b.value},null,8,["modelValue","page-count","total"])]),o(B,{ref_key:"deleteModal",ref:_,asignatura:k.value,selectedAsignaturas:t.value,onConfirm:C},null,8,["asignatura","selectedAsignaturas"])])),_:1})}}}),I=t({__name:"StatisticsChart",setup(a){const e=s([{name:"Valores",data:[]}]),t=s({chart:{id:"stats-chart"},xaxis:{categories:["Asignaturas totales","Estudiantes totales","Promedio de estudiantes","Asignaturas activas","Asignaturas inactivas","Materiales por asignatura"]},title:{text:"Estadísticas Generales"},plotOptions:{bar:{horizontal:!1}}});return r((async()=>{try{const[a,t,s,r,l]=await Promise.all([$fetch("/api/stats/subjects/count"),$fetch("/api/stats/students/count"),$fetch("/api/stats/students/average"),$fetch("/api/stats/asignaturas/active-inactive"),$fetch("/api/stats/materials/average")]);e.value=[{name:"Valores",data:[a.count,t.count,Number(s.average),r.active,r.inactive,Number(l.averageMaterials)]}]}catch(a){}})),(a,s)=>{const r=b("ApexChart");return i(),l("div",null,[o(r,{type:"bar",options:t.value,series:e.value},null,8,["options","series"])])}}}),J={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Z={class:"md:col-span-2"},H={class:"md:col-span-1"},K=t({__name:"asignaturas",setup:a=>(a,e)=>(i(),l("div",null,[c("div",J,[c("div",Z,[o(L)]),c("div",H,[o(I)])]),e[0]||(e[0]=c("br",null,null,-1)),o(G)]))});export{K as default};
