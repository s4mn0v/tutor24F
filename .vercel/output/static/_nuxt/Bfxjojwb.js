const t=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});function e(e,r){const o=n(r=r?{...t,...r}:t);return o.dispatch(e),o.toString()}const r=Object.freeze(["prototype","__proto__","constructor"]);function n(t){let e="",o=new Map;const s=t=>{e+=t};return{toString:()=>e,getContext:()=>o,dispatch(e){t.replacer&&(e=t.replacer(e));return this[null===e?"null":typeof e](e)},object(e){if(e&&"function"==typeof e.toJSON)return this.object(e.toJSON());const n=Object.prototype.toString.call(e);let a="";const c=n.length;a=c<10?"unknown:["+n+"]":n.slice(8,c-1),a=a.toLowerCase();let p=null;if(void 0!==(p=o.get(e)))return this.dispatch("[CIRCULAR:"+p+"]");if(o.set(e,o.size),"undefined"!=typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(e))return s("buffer:"),s(e.toString("utf8"));if("object"!==a&&"function"!==a&&"asyncfunction"!==a)this[a]?this[a](e):t.ignoreUnknown||this.unkown(e,a);else{let n=Object.keys(e);t.unorderedObjects&&(n=n.sort());let o=[];!1===t.respectType||i(e)||(o=r),t.excludeKeys&&(n=n.filter((e=>!t.excludeKeys(e))),o=o.filter((e=>!t.excludeKeys(e)))),s("object:"+(n.length+o.length)+":");const a=r=>{this.dispatch(r),s(":"),t.excludeValues||this.dispatch(e[r]),s(",")};for(const t of n)a(t);for(const t of o)a(t)}},array(e,r){if(r=void 0===r?!1!==t.unorderedArrays:r,s("array:"+e.length+":"),!r||e.length<=1){for(const t of e)this.dispatch(t);return}const i=new Map,a=e.map((e=>{const r=n(t);r.dispatch(e);for(const[t,n]of r.getContext())i.set(t,n);return r.toString()}));return o=i,a.sort(),this.array(a,!1)},date:t=>s("date:"+t.toJSON()),symbol:t=>s("symbol:"+t.toString()),unkown(t,e){if(s(e),t)return s(":"),t&&"function"==typeof t.entries?this.array(Array.from(t.entries()),!0):void 0},error:t=>s("error:"+t.toString()),boolean:t=>s("bool:"+t),string(t){s("string:"+t.length+":"),s(t)},function(e){s("fn:"),i(e)?this.dispatch("[native]"):this.dispatch(e.toString()),!1!==t.respectFunctionNames&&this.dispatch("function-name:"+String(e.name)),t.respectFunctionProperties&&this.object(e)},number:t=>s("number:"+t),xml:t=>s("xml:"+t.toString()),null:()=>s("Null"),undefined:()=>s("Undefined"),regexp:t=>s("regex:"+t.toString()),uint8array(t){return s("uint8array:"),this.dispatch(Array.prototype.slice.call(t))},uint8clampedarray(t){return s("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(t))},int8array(t){return s("int8array:"),this.dispatch(Array.prototype.slice.call(t))},uint16array(t){return s("uint16array:"),this.dispatch(Array.prototype.slice.call(t))},int16array(t){return s("int16array:"),this.dispatch(Array.prototype.slice.call(t))},uint32array(t){return s("uint32array:"),this.dispatch(Array.prototype.slice.call(t))},int32array(t){return s("int32array:"),this.dispatch(Array.prototype.slice.call(t))},float32array(t){return s("float32array:"),this.dispatch(Array.prototype.slice.call(t))},float64array(t){return s("float64array:"),this.dispatch(Array.prototype.slice.call(t))},arraybuffer(t){return s("arraybuffer:"),this.dispatch(new Uint8Array(t))},url:t=>s("url:"+t.toString()),map(e){s("map:");const r=[...e];return this.array(r,!1!==t.unorderedSets)},set(e){s("set:");const r=[...e];return this.array(r,!1!==t.unorderedSets)},file(t){return s("file:"),this.dispatch([t.name,t.size,t.type,t.lastModfied])},blob(){if(t.ignoreUnknown)return s("[blob]");throw new Error('Hashing Blob objects is currently not supported\nUse "options.replacer" or "options.ignoreUnknown"\n')},domwindow:()=>s("domwindow"),bigint:t=>s("bigint:"+t.toString()),process:()=>s("process"),timer:()=>s("timer"),pipe:()=>s("pipe"),tcp:()=>s("tcp"),udp:()=>s("udp"),tty:()=>s("tty"),statwatcher:()=>s("statwatcher"),securecontext:()=>s("securecontext"),connection:()=>s("connection"),zlib:()=>s("zlib"),context:()=>s("context"),nodescript:()=>s("nodescript"),httpparser:()=>s("httpparser"),dataview:()=>s("dataview"),signal:()=>s("signal"),fsevent:()=>s("fsevent"),tlswrap:()=>s("tlswrap")}}const o="[native code] }",s=o.length;function i(t){return"function"==typeof t&&Function.prototype.toString.call(t).slice(-s)===o}function a(t,r,n={}){return t===r||e(t,n)===e(r,n)}function c(t,e,r={}){return p(u(t,r),u(e,r),r)}function p(t,e,r={}){var n,o;const s=[],i=new Set([...Object.keys(t.props||{}),...Object.keys(e.props||{})]);if(t.props&&e.props)for(const a of i){const i=t.props[a],c=e.props[a];i&&c?s.push(...p(null==(n=t.props)?void 0:n[a],null==(o=e.props)?void 0:o[a],r)):(i||c)&&s.push(new l((c||i).key,i?"removed":"added",c,i))}return 0===i.size&&t.hash!==e.hash&&s.push(new l((e||t).key,"changed",e,t)),s}function u(t,r,n=""){if(t&&"object"!=typeof t)return new h(n,t,e(t,r));const o={},s=[];for(const e in t)o[e]=u(t[e],r,n?`${n}.${e}`:e),s.push(o[e].hash);return new h(n,t,`{${s.join(":")}}`,o)}class l{constructor(t,e,r,n){this.key=t,this.type=e,this.newValue=r,this.oldValue=n}toString(){return this.toJSON()}toJSON(){var t;switch(this.type){case"added":return`Added   \`${this.key}\``;case"removed":return`Removed \`${this.key}\``;case"changed":return`Changed \`${this.key}\` from \`${(null==(t=this.oldValue)?void 0:t.toString())||"-"}\` to \`${this.newValue.toString()}\``}}}class h{constructor(t,e,r,n){this.key=t,this.value=e,this.hash=r,this.props=n}toString(){return this.props?`{${Object.keys(this.props).join(",")}}`:JSON.stringify(this.value)}toJSON(){const t=this.key||".";return this.props?`${t}({${Object.keys(this.props).join(",")}})`:`${t}(${this.value})`}}export{c as d,a as i};
